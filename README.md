# 手動標註軟體 (Image Labeling Tool)

一個使用 PyQt5 開發的圖像標註工具，支援矩形框選、類別選擇、XML儲存等功能，採用文青風格的莫蘭迪色系界面設計。

## 功能特色

- **直觀的圖形界面**：莫蘭迪色系設計，簡潔文青風格
- **矩形框選標註**：滑鼠拖拽即可框選目標區域，粗體框線更清晰
- **多類別支援**：根據 label.txt 自動載入標註類別
- **標註顏色分配**：每個標註類別自動分配不同顏色（排除紅色）
- **XML 格式儲存**：標準 XML 格式儲存標註資料
- **自動載入**：支援已標註圖片的自動載入
- **完成功能**：標註完成後自動重置，支援連續作業

## 系統需求

- Python 3.6 或更高版本
- PyQt5
- Windows/macOS/Linux

## 安裝與執行

### 方法一：使用批次檔（Windows）

1. 雙擊 `run_annotation_tool.bat` 即可啟動

### 方法二：手動執行

1. 安裝依賴套件：
   ```bash
   pip install -r requirements.txt
   ```

2. 執行程式：
   ```bash
   python image_annotation_tool.py
   ```

## 資料格式

標註軟體需要以下資料夾結構：

```
project_folder/
├── label.txt          # 標註類別檔案（每行一個類別）
├── img/               # 圖片資料夾
│   ├── 1.jpg
│   ├── 2.jpg
│   └── ...
└── xml/               # 標註結果（程式自動建立）
    ├── 1.xml
    ├── 2.xml
    └── ...
```

### label.txt 範例

```
公車
機車
汽車
腳踏車
```

## 使用方法

1. **匯入資料夾**：點擊「匯入資料夾」按鈕，選擇包含 label.txt 和 img/ 的資料夾

2. **選擇類別**：在右側下拉選單中選擇要標註的類別
   - ⚠️ **重要**：必須先選擇類別才能進行標註

3. **框選標註**：
   - 選擇類別後，用滑鼠左鍵在圖片上拖拽框選矩形區域
   - 如果沒有選擇類別，系統會提醒您先選擇類別
   - 方框和類別文字以粗體顯示，更加清晰醒目

4. **圖片切換**：
   - 使用「上一張」、「下一張」按鈕切換圖片
   - 切換時會自動儲存當前圖片的標註
   - 自動清除上一張圖片的標註框顯示

5. **完成標註**：
   - 在最後一張圖片時會顯示「完成標註」按鈕
   - 點擊後會顯示XML檔案儲存位置
   - 程式會自動重新初始化回到起始狀態

6. **其他操作**：
   - 按 Delete 鍵刪除最後一個標註
   - 程式關閉時自動儲存當前標註

## 測試資料

專案包含測試資料夾 `test/`：
- 2 個標註類別：公車、機車
- 8 張測試圖片
- 可直接用於測試軟體功能

## 技術架構

- **MainWindow**：主視窗類別，負責介面佈局和事件處理
- **ImageCanvas**：圖片畫布類別，處理圖片顯示和滑鼠事件
- **AnnotationManager**：標註管理類別，負責 XML 檔案的讀取和儲存
- **ColorManager**：顏色管理類別，為每個類別分配唯一顏色

## 輸出格式

標註結果以 XML 格式儲存，相容於常見的標註工具：

```xml
<annotation>
  <filename>1.jpg</filename>
  <size>
    <width>640</width>
    <height>480</height>
    <depth>3</depth>
  </size>
  <object>
    <name>公車</name>
    <bndbox>
      <xmin>100</xmin>
      <ymin>150</ymin>
      <xmax>300</xmax>
      <ymax>250</ymax>
    </bndbox>
  </object>
</annotation>
```

## 注意事項

- 支援的圖片格式：JPG、JPEG、PNG、BMP、TIFF
- 建議圖片解析度不要過大，以確保標註精度
- XML 檔案會在圖片切換時自動儲存
- **必須先選擇標註類別才能進行標註**
- 點擊圖片區域可獲得焦點，確保 Delete 鍵正常工作
- 切換圖片時會自動清除前一張圖片的標註框顯示

## 專案發想

本專案的發想源自於 [labelImg](https://github.com/HumanSignal/labelImg) 這個優秀的圖像標註工具。我參考了 labelImg 的基本構想和使用者體驗設計，但完全從零開始實作，並沒有使用或修改 labelImg 的原始碼。

本專案的特色在於：
- 採用莫蘭迪色系的文青風格界面設計
- 簡化的操作流程，專注於基本的矩形標註功能
- 完全的 Python + PyQt5 實作，代碼結構清晰易懂
- 針對中文使用者優化的界面和說明
